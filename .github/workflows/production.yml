name: switch to/from maintenance mode

on:
  workflow_dispatch:
    inputs:
      old_filename:
        description: 'Maintenance: index.php / Mise en service: v2.php'
        required: true
        default: 'index.php'
      new_filename:
        description: 'Maintenance: v2.php / Mise en service: index.php'
        required: true
        default: 'v2.php'

jobs:
  rename-file:
    runs-on: ubuntu-latest
    
    steps:
      - name: Rename file via SSH
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SSH_HOST }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: ${{ secrets.SSH_PORT }}
          script: |
            echo "Renaming file..."
            mv "${{ github.event.inputs.old_filename }}" "${{ github.event.inputs.new_filename }}"
            echo "File renamed successfully!"
            echo "Verifying new file exists..."
            ls -lh "${{ github.event.inputs.new_filename }}"
